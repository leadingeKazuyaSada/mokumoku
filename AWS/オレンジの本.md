# 第1章 概要

- [公式試験ガイド](https://d1.awsstatic.com/ja_JP/training-and-certification/docs-sa-assoc/AWS-Certified-Solutions-Architect-Associate-Exam-Guide_v1.1_2019_08_27_FINAL.pdf)

教材

- 公式ドキュメント
- オンラインセミナー (Black Belt)
- [ホワイトペーパー](https://aws.amazon.com/jp/whitepapers/?whitepapers-main.sort-by=item.additionalFields.sortDate&whitepapers-main.sort-order=desc)
    - まずは "AWS Well-Architected フレームワーク" を読むべき。
- [公式トレーニング](http://aws.amazon.com/training)
- [ハンズオンチュートリアル](https://aws.amazon.com/jp/getting-started/hands-on/)
    - 個々のチュートリアルは10分程度で完了するものが多く、理解に役立つ。
- [セルフペースラボ](https://aws.amazon.com/jp/training/self-paced-labs/)
    - アカウント不要で動かしてみることが出来る。
- [ハンズオン for ビギナー](https://aws.amazon.com/jp/aws-jp-introduction/aws-jp-webinar-hands-on/?trk=aws_blog)

学習の進め方

- サービスを把握する
- アーキテクチャのベストプラクティスを知る
    - 運用
    - セキュリティ
    - 信頼性
    - パフォーマンス
    - コスト

重点ポイント

- 可用性 (?) の高い設計ができること
- スケーラビリティとパフォーマンスを意識できること
- コストを意識できること
- セキュリティを担保できること

最重要サービス

- IAM
    - Identity and Access Management
    - =権限管理
    - ユーザだけでなく、AWS リソースに権限を与えることも考える。
- VPC
    - Virtual Private Cloud
- EC2 (+EBS)
    - Elastic Compute Cloud
    - Web サーバ、バッチサーバなど
    - EBS = Elastic Block Store (ディスク)
- ELB (+Auto Scaling)
    - Elastic Load Balancing
    - Auto Scaling は動的にサーバ数を変える。
- RDS (Aurora)
    - Relational Database Service
    - Aurora の Amazon 独自の技術が重要。
- S3 (+S3 Glacier)
    - Simple Storage Service
    - ファイルが作られたことをトリガとして処理する等、他のサービスと連携するパターンあり

重要なサービス

- Route 53 (DNS)
- CloudWatch (監視サービス)
- CloudFormation (自動構築サービス)
- CloudFront (CDN)
- ElastiCache (キャッシュ)
- SQS (キュー)
- SNS (通知)

# 第2章

リージョン

- リージョンとは、AWS がサービスを提供している拠点 (国や地域)
- リージョンの中に、複数のアベイラビリティゾーン (AZ) がある。
- AZ の中に複数のデータセンターがある。

アベイラビリティゾーン

- AZ 同士は地理的・電源的に独立している。
- AZ 間のレイテンシは、だいたい2ミリ秒以下。
- ユーザがマルチ AZ を使わない場合は、障害への耐性はない。
- 可用性 (?) を高めるために、**マルチ AZ** に冗長的にインスタンスを配置するのが基本。

VPC

- VPC のインターネット側の出口を「インターネットゲートウェイ」(IGW) という。
- VPC に仮想プライベートゲートウェイ (VGW) をつけることで、Direct Connect (?) や VPN 経由で接続することも可能。
- AWS のサービスの中にも、VPC の中に入れられないものも結構ある。
    - S3, CloudWatch, DynamoDB など。
- VPC に対して、Classless Inter-Domain Routing (CIDR) ブロックの形式で IP アドレスの範囲を指定する。
- CIDR は最大でも /16 (x.x.0.0～x.x.255.255)。

サブネット

- CIDR をさらに細かく分けて、VPC 内にサブネットを作る。
- 個々のサブネットには1個のルータがある (とイメージする)。
- サブネット作成時に AZ を指定する (変更不可)。
- サブネットごとにルートテーブル (?) を1個指定する (いつでも変更可)。
- サブネットごとにネットワーク ACL (Access Control List : ファイアウォールのようなもの) を1個指定する (いつでも変更可)。
    - ルートテーブルとネットワーク ACL の設定を合わせて、仮想のルータになっていると言える。
- サブネットの数は200個まで (だが拡張できる)。
- サブネットの CIDR のうち、最初の4個と最後の1個は予約されていて使えない。
    - サブネットをたくさん作ると、使えない IP アドレスが増える。
- サービスによっては IP アドレスを何個か確保する必要がある (ELB なら8個、等)。
- 同じ役割を持ったサブネットを、複数の AZ に作ること。
- パブリックサブネット、プライベートサブネットは機能ではなく、ルーティングによる概念。

ルートテーブル

- ルートテーブルと各種ゲートウェイを用いて、VPC 内部の通信や、外部との通信をする。
- 1個のサブネットに、1個のルートテーブルを設定。
- 同じルートテーブルを別のサブネットに設定することもできる。1個のサブネットに複数のルートテーブルを設定することはできない。
- ルートテーブルは、宛先となるアドレスとターゲットとなるゲートウェイ (?) を指定する。
- VPC には「メインルートテーブル」がある。サブネットで指定しなかった場合のデフォルトとなる。

セキュリティグループ

- インスタンス単位の通信制御に使う。
- 各インスタンスに少なくとも1個のセキュリティグループをアタッチする。
- インバウンド、アウトバウンドの制御が可能。
- 制御項目
    - プロトコル
    - ポート
    - CIDR またはセキュリティブループ
- 何も設定しないとすべてのアクセスを拒否する (?)。
    - ※黒本によると、アウトバウンドは許可する。
- ステートフル。応答トラフィック (レスポンス) は許可する。

ネットワーク ACL

- サブネットごとの通信制御に使う。
- インバウンド、アウトバウンドの制御が可能。
- 制御項目
    - ポート
    - CIDR
- 何も設定しないとすべての通信を許可する (?)。
    - 黒本によると、それはデフォルトのネットワーク ACL の話らしい (何も設定しないとそれを使うからか)。
    - 新規でカスタムネットワーク ACL を作った時の初期値は、「すべて拒否」とのこと。
- ステートレス。応答トラフィックであろうと設定による許可が必要。

ゲートウェイ

- VPC の中と外をつなぐ「出入り口」。
- IGW (インターネットゲートウェイ)
    - VPC をインターネットと接続する。
- VGW (仮想プライベートゲートウェイ)
    - VPN や Direct Connect を経由して他の (オンプレミスの) ネットワークと接続する。

インターネットゲートウェイ (IGW)

- 各 VPC に1個アタッチする (ことができる)。
- 設定は特にない。
- 単一障害点 (SPOF: Single Point Of Failure) になり得るか？
    - IGW は AWS managed なサービス。
    - 冗長化、障害時の復旧は自動的になされる。
- ルートテーブルで IGW をターゲットにするとインターネットに繋がる。
    - パブリックサブネットはそうなっている。
- プライベートサブネットにあるインスタンス (EC2) も、NAT ゲートウェイを通してインターネットに接続できる。
    - NAT ゲートウェイはパブリックサブネットにある。
    - NAT ゲートウェイは AZ ごとに必要。

仮想プライベートゲートウェイ (VGW)

- 各 VPC に1個アタッチする (ことができる)。
- 1個で複数の VPN や Direct Connect と接続できる。
- ルートテーブルで IGW をターゲットにすると (遠隔の) オンプレミスネットワークに繋がる。
    - 宛先は、静的に記載する方法と、ルート伝播 (プロパゲーション) 機能で動的に決める方法がある。

VPC エンドポイント

- IGW を使わずに (インターネットを通らずに) VPC から他の AWS サービスに接続できる。
- ゲートウェイエンドポイント
    - S3 や DynamoDB にプライベート接続する。
- インターフェイスエンドポイント (AWS PrivateLink)
    - S3 や DynamoDB 以外のサービスの API にプライベート接続する。

VPC ピアリング

- 2つの VPC 間でプライベートな接続をする。
- AWS アカウントをまたがっての接続も可能。

VPC フローログ

- VPC 内の通信の解析に使う。
- ENI (Elastic Network Interface) 単位で記録される。
    - ENI: 仮想ネットワークインターフェイスカード

AWS Direct Connect

- AWS とオフィスやデータセンターを専用線で繋げる。
- ゲートウェイは VGW を使う。
- VPN より速くて安定する。
- アウトバウンドトラフィック料金は Direct Connect 経由の方が安い (VPN より?)。
- Direct Connect Gateway
    - 1つの Direct Connect 接続で、拠点と複数の AWS アカウントや VPC に接続。
- AWS Transit Gateway
    - 複数の VPC とオンプレミスネットワークを、中央ハブ (?) を介して接続。
- 2つの AWS 間で Site-to-Site VPN はできない (Direct Connect を使う)。

# 第3章

